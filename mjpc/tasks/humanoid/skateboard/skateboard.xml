<mujoco model="skateboard">
  <default>
    <default class="skateboard">
      <default class="board">
        <geom solimp="0.5 0.99 1e-4" solref=".001 1" />
        <default class="grip">
          <site group="0" rgba="0.2 0.2 0.2 1" />
        </default>
        <default class="wood">
          <geom friction="1.5 0.005 0.0001" rgba="0.5859 0.4336 0.1992 1" />
        </default>
      </default>

      <default class="hanger-rotate">
        <joint type="hinge" range="-9 +9" damping="5" stiffness="5"/>
      </default>

      <default class="truck">
        <geom type="capsule" size="0.03" rgba="0.4414 0.4727 0.4922 1"/>
      </default>

      <default class="wheel">
        <geom type="cylinder" size="0.04 0.02" rgba="0.1 0.1 0.1 1" quat="1 1 0 0" condim="6" friction="1 0.005 0.0001"/>
        <joint type="hinge" axis="0 1 0" frictionloss="0.005"/>
      </default>

      <default class="wheel-marker">
        <site type="capsule" group="0" size="0.001 0.019"/>
      </default>
    </default>

    <default class="tracking_site_board">
      <site type="sphere" size="0.027" rgba="0 1 0 1" group="3"/>
    </default>
  </default>

  <worldbody>
    <body name="skateboard" pos="0 0 0">
      <freejoint/>

      <camera name="skateboard:back-targetbodycom" pos="-3 0 2" xyaxes="0 -1 0 1 0 2" mode="targetbodycom"/>
      <camera name="skateboard:back-trackcom" pos="-3 0 2" xyaxes="0 -1 0 1 0 2" mode="trackcom"/>
      <camera name="skateboard:side-targetbodycom" pos="0 -3 2" xyaxes="1 0 0 0 1 2" mode="targetbodycom"/>
      <camera name="skateboard:side-trackcom" pos="0 -3 2" xyaxes="1 0 0 0 1 2" mode="trackcom"/>
      <camera name="skateboard:far-chase-trackcom" pos="-6 -6 5" xyaxes="0.746 -0.666 0.000 0.283 0.317 0.905" mode="trackcom"/>

      <!-- board -->
      <body name="board" pos="0 0 0.005">
        <joint name="board-tilt" axis="-1 0 0" range="-18 18" damping="30" stiffness="30"/>
        <body name="board-center">
          <geom name="board-base" class="wood" type="box" size="0.3 0.13 0.01" />
          <site name="board-base-grip" class="grip" type="box" size="0.3 0.13 0.0001" pos="0 0 0.01" />
        </body>
        <body name="board-nose" pos="+0.3685 0.0 0.0225" quat="-0.9659 0 0.15 0" >
          <geom name="board-nose" class="wood" type="box" size="0.075 0.13 0.01" />
          <site name="board-nose-grip" class="grip" type="box" size="0.074 0.13 0.0001" pos="+0.001 0 0.01" />
        </body>
        <body name="board-tail" pos="-0.3685 0.0 0.0225" quat="+0.9659 0 0.15 0" >
          <geom name="board-tail" class="wood" type="box" size="0.075 0.13 0.01" />
          <site name="board-tail-grip" class="grip" type="box" size="0.074 0.13 0.0001" pos="-0.001 0 0.01" />
        </body>
      </body>
      <!-- trucks -->
      <geom  name="truck-nose" class="truck" fromto="0.20 0.0 -0.020 0.30 0.0 -0.020" />
      <geom  name="truck-tail" class="truck" fromto="-0.20 0.0 -0.020 -0.30 0.0 -0.020" />

      <!-- Baseplate -->
      <body name="baseplate-front" pos="0.25 0.0 -0.01">
        <!-- rotate -->
        <body name="kingpin-front" pos="0 0 -0.01">
          <site name="track-front-plate" class="tracking_site_board"  pos="-0.05 0.00 0.05" />
          <geom type="capsule" fromto="0 0 0 0 0 -0.02" size="0.01" rgba="0.5 0.5 0.5 1"/>
          <joint name="hanger-rotate-front" class="hanger-rotate" axis="0 0 1" />
          <!-- Bushings and hanger -->
          <body name="bushings-and-hanger-front" pos="0 0 -0.02">
            <geom name="bottom-bushing-front" type="ellipsoid" size="0.03 0.03 0.01" rgba="1 0 0 1"/>
            <geom name="hanger-front" type="box" size="0.02 0.12 0.02" pos="0 0 -0.03" rgba="0.5 0.5 0.5 1"/>
            <!-- Wheels -->
            <body name="wheel-front-left" pos="0.0 0.15 -0.03" >
              <joint name="wheel-front-left" class="wheel"/>
              <geom name="wheel-front-left" class="wheel"/>
              <site name="wheel-marker-front-left" class="wheel-marker" pos="0 0.02 0.02"/>
            </body>
            <body name="wheel-front-right" pos="0.0 -0.15 -0.03">
              <joint name="wheel-front-right" class="wheel"/>
              <geom name="wheel-front-right" class="wheel"/>
              <site name="wheel-marker-front-right" class="wheel-marker" pos="0 -0.02 0.02"/>
            </body>
          </body>
        </body>
      </body>
      <!-- identical but for back truck -->
      <body name="baseplate-back" pos="-0.25 0.0 -0.01">
        <body name="kingpin-back" pos="0 0 -0.01">
          <site name="track-back-plate" class="tracking_site_board"  pos="0.05 0.00 0.05" />
          <site name="track-tail" class="tracking_site_board"  pos="-0.1 0.00 0.05" />
          <geom type="capsule" fromto="0 0 0 0 0 -0.02" size="0.01" rgba="0.5 0.5 0.5 1"/>
          <joint name="hanger-rotate-back" class="hanger-rotate" axis="0 0 -1"/>
          <!-- Bushings and hanger -->
          <body name="bushings-and-hanger-back" pos="0 0 -0.02">
            <geom name="bottom-bushing-back" type="ellipsoid" size="0.03 0.03 0.01" rgba="1 0 0 1"/>
            <geom name="hanger-back" type="box" size="0.015 0.12 0.015" pos="0 0 -0.03" rgba="0.5 0.5 0.5 1"/>

            <!-- Wheels -->
            <body name="wheel-back-left" pos="0.0 0.15 -0.03">
              <joint name="wheel-back-left" class="wheel"/>
              <geom name="wheel-back-left" class="wheel"/>
              <site name="wheel-marker-back-left" class="wheel-marker" pos="0 0.02 0.02"/>
            </body>
            <body name="wheel-back-right" pos="0.0 -0.15 -0.03">
              <joint name="wheel-back-right" class="wheel"/>
              <geom name="wheel-back-right" class="wheel"/>
              <site name="wheel-marker-back-right" class="wheel-marker" pos="0 -0.02 0.02"/>
            </body>
          </body>
        </body>
      </body>
    </body>
  </worldbody>
  <!-- equality/joint between hanger-rotate and hanger-rotate-back -->
  <equality>
    <joint joint1="hanger-rotate-back" joint2="board-tilt" polycoef="0 2.0 0 0 0"/>
    <joint joint1="hanger-rotate-front" joint2="board-tilt" polycoef="0 2.0 0 0 0"/>
  </equality>
  <!-- exlude contact between all board parts,   trucks and kingpins and hangars -->
  <contact>
        <exclude body1="board" body2="baseplate-front"/>
        <exclude body1="board" body2="baseplate-back"/>
        <exclude body1="board" body2="wheel-front-left"/>
        <exclude body1="board" body2="wheel-front-right"/>
        <exclude body1="board" body2="wheel-back-left"/>
        <exclude body1="board" body2="wheel-back-right"/>
        <exclude body1="board" body2="kingpin-front"/>
        <exclude body1="board" body2="kingpin-back"/>
        <exclude body1="board" body2="bushings-and-hanger-front"/>
        <exclude body1="board" body2="bushings-and-hanger-back"/>

        <exclude body1="board-center" body2="baseplate-front"/>
        <exclude body1="board-center" body2="baseplate-back"/>
        <exclude body1="board-center" body2="wheel-front-left"/>
        <exclude body1="board-center" body2="wheel-front-right"/>
        <exclude body1="board-center" body2="wheel-back-left"/>
        <exclude body1="board-center" body2="wheel-back-right"/>
        <exclude body1="board-center" body2="kingpin-front"/>
        <exclude body1="board-center" body2="kingpin-back"/>
        <exclude body1="board-center" body2="bushings-and-hanger-front"/>
        <exclude body1="board-center" body2="bushings-and-hanger-back"/>

        <exclude body1="baseplate-front" body2="wheel-front-left"/>
        <exclude body1="baseplate-front" body2="wheel-front-right"/>
        <exclude body1="baseplate-front" body2="wheel-back-left"/>
        <exclude body1="baseplate-front" body2="wheel-back-right"/>
        <exclude body1="baseplate-back" body2="wheel-front-left"/>
        <exclude body1="baseplate-back" body2="wheel-front-right"/>
        <exclude body1="baseplate-back" body2="wheel-back-left"/>
        <exclude body1="baseplate-back" body2="wheel-back-right"/>
        <exclude body1="wheel-front-left" body2="wheel-front-right"/>
        <exclude body1="wheel-front-left" body2="wheel-back-left"/>
        <exclude body1="wheel-front-left" body2="wheel-back-right"/>
        <exclude body1="wheel-front-right" body2="wheel-back-left"/>
        <exclude body1="wheel-front-right" body2="wheel-back-right"/>
        <exclude body1="wheel-back-left" body2="wheel-back-right"/>
        <exclude body1="baseplate-front" body2="baseplate-back"/>
        <exclude body1="baseplate-front" body2="kingpin-front"/>
        <exclude body1="baseplate-front" body2="kingpin-back"/>
        <exclude body1="baseplate-front" body2="bushings-and-hanger-front"/>
        <exclude body1="baseplate-front" body2="bushings-and-hanger-back"/>
        <exclude body1="baseplate-back" body2="kingpin-front"/>
        <exclude body1="baseplate-back" body2="kingpin-back"/>
        <exclude body1="baseplate-back" body2="bushings-and-hanger-front"/>
        <exclude body1="baseplate-back" body2="bushings-and-hanger-back"/>
        <exclude body1="kingpin-front" body2="kingpin-back"/>
        <exclude body1="kingpin-front" body2="bushings-and-hanger-front"/>
        <exclude body1="kingpin-front" body2="bushings-and-hanger-back"/>
        <exclude body1="kingpin-back" body2="bushings-and-hanger-front"/>
        <exclude body1="kingpin-back" body2="bushings-and-hanger-back"/>
        <exclude body1="bushings-and-hanger-front" body2="bushings-and-hanger-back"/>
      </contact>
</mujoco>
